// Generated by ASN1.ERP.UNO Compiler, Copyright © 2023—2024 Namdak Tönpa.
import SwiftASN1
import Foundation

@usableFromInline struct ExtendedSecurityServices_2009_ESSSecurityLabel: DERImplicitlyTaggable, Hashable, Sendable {
    @inlinable static var defaultIdentifier: ASN1Identifier { .set }
    @usableFromInline var security_policy_identifier: ExtendedSecurityServices_2009_SecurityPolicyIdentifier
    @usableFromInline var security_classification: ExtendedSecurityServices_2009_SecurityClassification?
    @usableFromInline var privacy_mark: ExtendedSecurityServices_2009_ESSPrivacyMark?
    @usableFromInline var security_categories: ExtendedSecurityServices_2009_SecurityCategories?
    @inlinable init(security_policy_identifier: ExtendedSecurityServices_2009_SecurityPolicyIdentifier, security_classification: ExtendedSecurityServices_2009_SecurityClassification?, privacy_mark: ExtendedSecurityServices_2009_ESSPrivacyMark?, security_categories: ExtendedSecurityServices_2009_SecurityCategories?) {
        self.security_policy_identifier = security_policy_identifier
        self.security_classification = security_classification
        self.privacy_mark = privacy_mark
        self.security_categories = security_categories
    }
    @inlinable init(derEncoded root: ASN1Node,
        withIdentifier identifier: ASN1Identifier) throws {
        self = try DER.set(root, identifier: identifier) { nodes in
            let security_policy_identifier: ExtendedSecurityServices_2009_SecurityPolicyIdentifier = try ExtendedSecurityServices_2009_SecurityPolicyIdentifier(derEncoded: &nodes)
            let security_classification: ExtendedSecurityServices_2009_SecurityClassification? = try ExtendedSecurityServices_2009_SecurityClassification(derEncoded: &nodes)
            let privacy_mark: ExtendedSecurityServices_2009_ESSPrivacyMark? = try ExtendedSecurityServices_2009_ESSPrivacyMark(derEncoded: &nodes)
            let security_categories: ExtendedSecurityServices_2009_SecurityCategories? = try ExtendedSecurityServices_2009_SecurityCategories(derEncoded: &nodes)
            return ExtendedSecurityServices_2009_ESSSecurityLabel(security_policy_identifier: security_policy_identifier, security_classification: security_classification, privacy_mark: privacy_mark, security_categories: security_categories)
        }
    }
    @inlinable func serialize(into coder: inout DER.Serializer,
        withIdentifier identifier: ASN1Identifier) throws {
        try coder.appendConstructedNode(identifier: identifier) { coder in
            try coder.serialize(security_policy_identifier)
            if let security_classification = self.security_classification { if let security_classification = self.security_classification { try coder.serialize(security_classification) } }
            if let privacy_mark = self.privacy_mark { if let privacy_mark = self.privacy_mark { try coder.serialize(privacy_mark) } }
            if let security_categories = self.security_categories { if let security_categories = self.security_categories { try coder.serialize(security_categories) } }
        }
    }
}
