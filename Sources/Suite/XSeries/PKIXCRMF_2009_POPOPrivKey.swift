// Generated by ASN1.ERP.UNO Compiler, Copyright © 2023—2024 Namdak Tönpa.
import SwiftASN1
import Foundation

@usableFromInline indirect enum PKIXCRMF_2009_POPOPrivKey: DERImplicitlyTaggable, DERParseable, DERSerializable, Sendable {
    @inlinable static var defaultIdentifier: ASN1Identifier { .enumerated }
        case thisMessage(ASN1BitString)
    case subsequentMessage(PKIXCRMF_2009_SubsequentMessage)
    case dhMAC(ASN1BitString)
    case agreeMAC(PKIXCRMF_2009_PKMACValue)
    case encryptedKey(PKCS_7_EnvelopedData)
    @inlinable init(derEncoded rootNode: ASN1Node, withIdentifier identifier: ASN1Identifier) throws {
        switch rootNode.identifier {
        case ASN1Identifier(tagWithNumber: 0, tagClass: .contextSpecific):
            self = .thisMessage(try ASN1BitString(derEncoded: rootNode, withIdentifier: rootNode.identifier))
        case ASN1Identifier(tagWithNumber: 1, tagClass: .contextSpecific):
            self = .subsequentMessage(try PKIXCRMF_2009_SubsequentMessage(derEncoded: rootNode, withIdentifier: rootNode.identifier))
        case ASN1Identifier(tagWithNumber: 2, tagClass: .contextSpecific):
            self = .dhMAC(try ASN1BitString(derEncoded: rootNode, withIdentifier: rootNode.identifier))
        case ASN1Identifier(tagWithNumber: 3, tagClass: .contextSpecific):
            self = .agreeMAC(try PKIXCRMF_2009_PKMACValue(derEncoded: rootNode, withIdentifier: rootNode.identifier))
        case ASN1Identifier(tagWithNumber: 4, tagClass: .contextSpecific):
            self = .encryptedKey(try PKCS_7_EnvelopedData(derEncoded: rootNode, withIdentifier: rootNode.identifier))
            default: throw ASN1Error.unexpectedFieldType(rootNode.identifier)
        }
    }
    @inlinable func serialize(into coder: inout DER.Serializer, withIdentifier identifier: ASN1Identifier) throws {
        switch self {
        case .thisMessage(let thisMessage): try thisMessage.serialize(into: &coder, withIdentifier: ASN1Identifier(tagWithNumber: 0, tagClass: .contextSpecific))
        case .subsequentMessage(let subsequentMessage): try subsequentMessage.serialize(into: &coder, withIdentifier: ASN1Identifier(tagWithNumber: 1, tagClass: .contextSpecific))
        case .dhMAC(let dhMAC): try dhMAC.serialize(into: &coder, withIdentifier: ASN1Identifier(tagWithNumber: 2, tagClass: .contextSpecific))
        case .agreeMAC(let agreeMAC): try agreeMAC.serialize(into: &coder, withIdentifier: ASN1Identifier(tagWithNumber: 3, tagClass: .contextSpecific))
        case .encryptedKey(let encryptedKey): try encryptedKey.serialize(into: &coder, withIdentifier: ASN1Identifier(tagWithNumber: 4, tagClass: .contextSpecific))

        }
    }

}
