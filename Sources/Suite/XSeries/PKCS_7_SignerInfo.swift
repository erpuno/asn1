// Generated by ASN1.ERP.UNO Compiler, Copyright © 2023—2024 Namdak Tönpa.
import SwiftASN1
import Foundation

@usableFromInline struct PKCS_7_SignerInfo: DERImplicitlyTaggable, Hashable, Sendable {
    @inlinable static var defaultIdentifier: ASN1Identifier { .sequence }
    @usableFromInline var version: PKCS_7_SignerInfo_version_IntEnum
    @usableFromInline var issuerAndSerialNumber: PKCS_7_IssuerAndSerialNumber
    @usableFromInline var digestAlgorithm: PKCS_7_DigestAlgorithmIdentifier
    @usableFromInline var authenticatedAttributes: PKCS_7_SignerInfo_authenticatedAttributes_Choice?
    @usableFromInline var digestEncryptionAlgorithm: PKCS_7_DigestEncryptionAlgorithmIdentifier
    @usableFromInline var encryptedDigest: PKCS_7_EncryptedDigest
    @usableFromInline var unauthenticatedAttributes: PKCS_7_SignerInfo_unauthenticatedAttributes_Choice?
    @inlinable init(version: PKCS_7_SignerInfo_version_IntEnum, issuerAndSerialNumber: PKCS_7_IssuerAndSerialNumber, digestAlgorithm: PKCS_7_DigestAlgorithmIdentifier, authenticatedAttributes: PKCS_7_SignerInfo_authenticatedAttributes_Choice?, digestEncryptionAlgorithm: PKCS_7_DigestEncryptionAlgorithmIdentifier, encryptedDigest: PKCS_7_EncryptedDigest, unauthenticatedAttributes: PKCS_7_SignerInfo_unauthenticatedAttributes_Choice?) {
        self.version = version
        self.issuerAndSerialNumber = issuerAndSerialNumber
        self.digestAlgorithm = digestAlgorithm
        self.authenticatedAttributes = authenticatedAttributes
        self.digestEncryptionAlgorithm = digestEncryptionAlgorithm
        self.encryptedDigest = encryptedDigest
        self.unauthenticatedAttributes = unauthenticatedAttributes
    }
    @inlinable init(derEncoded root: ASN1Node,
        withIdentifier identifier: ASN1Identifier) throws {
        self = try DER.sequence(root, identifier: identifier) { nodes in
            let version = try PKCS_7_SignerInfo_version_IntEnum(rawValue: Int(derEncoded: &nodes))
            let issuerAndSerialNumber: PKCS_7_IssuerAndSerialNumber = try PKCS_7_IssuerAndSerialNumber(derEncoded: &nodes)
            let digestAlgorithm: PKCS_7_DigestAlgorithmIdentifier = try PKCS_7_DigestAlgorithmIdentifier(derEncoded: &nodes)
            var authenticatedAttributes: PKCS_7_SignerInfo_authenticatedAttributes_Choice? = nil
var peek_authenticatedAttributes = nodes
if let next = peek_authenticatedAttributes.next(), next.identifier == PKCS_7_SignerInfo_authenticatedAttributes_Choice.defaultIdentifier {
    authenticatedAttributes = try PKCS_7_SignerInfo_authenticatedAttributes_Choice(derEncoded: &nodes)
}
            let digestEncryptionAlgorithm: PKCS_7_DigestEncryptionAlgorithmIdentifier = try PKCS_7_DigestEncryptionAlgorithmIdentifier(derEncoded: &nodes)
            let encryptedDigest: PKCS_7_EncryptedDigest = try PKCS_7_EncryptedDigest(derEncoded: &nodes)
            var unauthenticatedAttributes: PKCS_7_SignerInfo_unauthenticatedAttributes_Choice? = nil
var peek_unauthenticatedAttributes = nodes
if let next = peek_unauthenticatedAttributes.next(), next.identifier == PKCS_7_SignerInfo_unauthenticatedAttributes_Choice.defaultIdentifier {
    unauthenticatedAttributes = try PKCS_7_SignerInfo_unauthenticatedAttributes_Choice(derEncoded: &nodes)
}
            return PKCS_7_SignerInfo(version: version, issuerAndSerialNumber: issuerAndSerialNumber, digestAlgorithm: digestAlgorithm, authenticatedAttributes: authenticatedAttributes, digestEncryptionAlgorithm: digestEncryptionAlgorithm, encryptedDigest: encryptedDigest, unauthenticatedAttributes: unauthenticatedAttributes)
        }
    }
    @inlinable func serialize(into coder: inout DER.Serializer,
        withIdentifier identifier: ASN1Identifier) throws {
        try coder.appendConstructedNode(identifier: identifier) { coder in
            try coder.serialize(version.rawValue)
            try coder.serialize(issuerAndSerialNumber)
            try coder.serialize(digestAlgorithm)
            if let authenticatedAttributes = self.authenticatedAttributes { if let authenticatedAttributes = self.authenticatedAttributes { try coder.serialize(authenticatedAttributes) } }
            try coder.serialize(digestEncryptionAlgorithm)
            try coder.serialize(encryptedDigest)
            if let unauthenticatedAttributes = self.unauthenticatedAttributes { if let unauthenticatedAttributes = self.unauthenticatedAttributes { try coder.serialize(unauthenticatedAttributes) } }
        }
    }
}
